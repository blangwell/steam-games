<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="//cdn.jsdelivr.net/npm/phaser@3.24.0/dist/phaser.min.js"></script>
  <link rel="stylesheet" href="assets/style.css">
  <title>Math Cannon</title>
</head>

<body>
  <h1 id="title">Math Cannon</h1>
  <script>
    
  // bind scene to new Scene instance object
  const scene = new Phaser.Scene('game');
  
  const config = {
    width: 800,
    height: 600,
    type: Phaser.AUTO,
    // physics: {
      //   default: 'arcade',
      //   arcade: {
        //     fps: 60,
        //     gravity: {y : 0},
        //   }
        // },
        scene: scene
      };
      
      
      const game = new Phaser.Game(config);

  // we are EXTENDING our scene objects via functions (function expression syntax)
  // now we create scene functions which run at certain intervals

  // init => sets up vars like lives, health, ammo, etc
  scene.init = function() {
    this.score = 0;
    this.lives = 3;
    this.scoreText;
    this.equation;
    
  }
  
  // preload => preloads assets into the game prior to render
  scene.preload = function() {
    this.load.image('background', 'assets/img/space-bg.jpg')
    this.load.image('crosshair', 'assets/img/crossair_blueOutline.png')
    this.load.image('laser', 'assets/img/laserGreen03.png')
    this.load.audio('laserSound', 'assets/sounds/laser1.ogg')
  }
  
  // create => loaded once preload has finished, position character, add text etc
  let ch;
  let laser;

  scene.create = function() {
    let bg = this.add.sprite(0, 0, 'background');
    bg.setOrigin(0, 0);

    ch = this.add.sprite(config.width/2, config.height/2, 'crosshair')
    laser = this.add.sprite(config.width/2, config.height , 'laser')


    // add.text(x, y, 'text', {styling object props})
    this.scoreText = this.add.text(16, 16, 'score : '+ this.score, {fontSize: '20px', fill: '#fff'})
    this.liveText = this.add.text(16, config.height-50, 'Lives : ' + this.lives, {fontSize: '20px', fill: '#fff'})

  }
  
  // let fireLasers = function(laser, speed) {
  //   while (laser.y > 0) {
  //     this.laser.anims.play('laser')

  //   }
  // }

  // update => core function of the game, runs 60x/second used for interaction
  let cursors;

  scene.update = function() {
    cursors = this.input.keyboard.createCursorKeys();

    // player movement
    if (cursors.left.isDown) ch.x -= 10;
    if (cursors.right.isDown) ch.x += 10;
    if (cursors.up.isDown) ch.y -= 10;
    if (cursors.down.isDown) ch.y += 10;

    if (cursors.space.isDown) {
      this.sound.play('laserSound')
    } 
    
  }
  
  // end => called once the game is over, ie out of lives, end of level
  scene.end = function() {

  }

  </script>
</body>
</html>

